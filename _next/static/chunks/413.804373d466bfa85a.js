"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[413],{86362:function(e,t,s){s.r(t),s.d(t,{default:function(){return e7}});var a=s(57437),r=s(2265),n=s(40521),l=s(48614),i=s(69266);s(2446);var o=s(83037),c=s(88070),d=s(26433),m=s(61994),u=s(53335);function h(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];return(0,u.m6)((0,m.W)(t))}var x=s(37053),g=s(90535);let p=(0,g.j)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",{variants:{variant:{default:"bg-primary text-primary-foreground shadow-xs hover:bg-primary/90",destructive:"bg-destructive text-white shadow-xs hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50",secondary:"bg-secondary text-secondary-foreground shadow-xs hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2 has-[>svg]:px-3",sm:"h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5",lg:"h-10 rounded-md px-6 has-[>svg]:px-4",icon:"size-9"}},defaultVariants:{variant:"default",size:"default"}});function f(e){let{className:t,variant:s,size:r,asChild:n=!1,...l}=e,i=n?x.g7:"button";return(0,a.jsx)(i,{"data-slot":"button",className:h(p({variant:s,size:r,className:t})),...l})}function b(e){let{className:t,...s}=e;return(0,a.jsx)("textarea",{"data-slot":"textarea",className:h("border-input placeholder:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 flex field-sizing-content min-h-16 w-full rounded-md border bg-transparent px-3 py-2 text-base shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",t),...s})}function y(e){let{className:t,...s}=e;return(0,a.jsx)("div",{"data-slot":"card",className:h("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",t),...s})}function v(e){let{className:t,...s}=e;return(0,a.jsx)("div",{"data-slot":"card-header",className:h("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-1.5 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",t),...s})}function j(e){let{className:t,...s}=e;return(0,a.jsx)("div",{"data-slot":"card-title",className:h("leading-none font-semibold",t),...s})}function k(e){let{className:t,...s}=e;return(0,a.jsx)("div",{"data-slot":"card-description",className:h("text-muted-foreground text-sm",t),...s})}function w(e){let{className:t,...s}=e;return(0,a.jsx)("div",{"data-slot":"card-content",className:h("px-6",t),...s})}var N=s(50035),S=s(40875),C=s(30401),E=s(22135);function T(e){let{...t}=e;return(0,a.jsx)(N.fC,{"data-slot":"select",...t})}function A(e){let{...t}=e;return(0,a.jsx)(N.ZA,{"data-slot":"select-group",...t})}function P(e){let{...t}=e;return(0,a.jsx)(N.B4,{"data-slot":"select-value",...t})}function R(e){let{className:t,size:s="default",children:r,...n}=e;return(0,a.jsxs)(N.xz,{"data-slot":"select-trigger","data-size":s,className:h("border-input data-[placeholder]:text-muted-foreground [&_svg:not([class*='text-'])]:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 dark:hover:bg-input/50 flex w-fit items-center justify-between gap-2 rounded-md border bg-transparent px-3 py-2 text-sm whitespace-nowrap shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 data-[size=default]:h-9 data-[size=sm]:h-8 *:data-[slot=select-value]:line-clamp-1 *:data-[slot=select-value]:flex *:data-[slot=select-value]:items-center *:data-[slot=select-value]:gap-2 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",t),...n,children:[r,(0,a.jsx)(N.JO,{asChild:!0,children:(0,a.jsx)(S.Z,{className:"size-4 opacity-50"})})]})}function I(e){let{className:t,children:s,position:r="popper",...n}=e;return(0,a.jsx)(N.h_,{children:(0,a.jsxs)(N.VY,{"data-slot":"select-content",className:h("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 relative z-50 max-h-(--radix-select-content-available-height) min-w-[8rem] origin-(--radix-select-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border shadow-md","popper"===r&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",t),position:r,...n,children:[(0,a.jsx)(_,{}),(0,a.jsx)(N.l_,{className:h("p-1","popper"===r&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)] scroll-my-1"),children:s}),(0,a.jsx)(Z,{})]})})}function z(e){let{className:t,...s}=e;return(0,a.jsx)(N.__,{"data-slot":"select-label",className:h("text-muted-foreground px-2 py-1.5 text-xs",t),...s})}function F(e){let{className:t,children:s,...r}=e;return(0,a.jsxs)(N.ck,{"data-slot":"select-item",className:h("focus:bg-accent focus:text-accent-foreground [&_svg:not([class*='text-'])]:text-muted-foreground relative flex w-full cursor-default items-center gap-2 rounded-sm py-1.5 pr-8 pl-2 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4 *:[span]:last:flex *:[span]:last:items-center *:[span]:last:gap-2",t),...r,children:[(0,a.jsx)("span",{className:"absolute right-2 flex size-3.5 items-center justify-center",children:(0,a.jsx)(N.wU,{children:(0,a.jsx)(C.Z,{className:"size-4"})})}),(0,a.jsx)(N.eT,{children:s})]})}function _(e){let{className:t,...s}=e;return(0,a.jsx)(N.u_,{"data-slot":"select-scroll-up-button",className:h("flex cursor-default items-center justify-center py-1",t),...s,children:(0,a.jsx)(E.Z,{className:"size-4"})})}function Z(e){let{className:t,...s}=e;return(0,a.jsx)(N.$G,{"data-slot":"select-scroll-down-button",className:h("flex cursor-default items-center justify-center py-1",t),...s,children:(0,a.jsx)(S.Z,{className:"size-4"})})}var q=s(76865),D=s(51817),G=s(11239),O=s(92934),M=s(82431),U=s(68919),K=s(32489),B=s(64719),L=s(75368),V=s(17689),H=s(88964),Q=s(10407),Y=s(96362);let J=(0,g.j)("relative w-full rounded-lg border px-4 py-3 text-sm grid has-[>svg]:grid-cols-[calc(var(--spacing)*4)_1fr] grid-cols-[0_1fr] has-[>svg]:gap-x-3 gap-y-0.5 items-start [&>svg]:size-4 [&>svg]:translate-y-0.5 [&>svg]:text-current",{variants:{variant:{default:"bg-card text-card-foreground",destructive:"text-destructive bg-card [&>svg]:text-current *:data-[slot=alert-description]:text-destructive/90"}},defaultVariants:{variant:"default"}});function W(e){let{className:t,variant:s,...r}=e;return(0,a.jsx)("div",{"data-slot":"alert",role:"alert",className:h(J({variant:s}),t),...r})}function $(e){let{className:t,...s}=e;return(0,a.jsx)("div",{"data-slot":"alert-title",className:h("col-start-2 line-clamp-1 min-h-4 font-medium tracking-tight",t),...s})}function X(e){let{className:t,...s}=e;return(0,a.jsx)("div",{"data-slot":"alert-description",className:h("text-muted-foreground col-start-2 grid justify-items-start gap-1 text-sm [&_p]:leading-relaxed",t),...s})}var ee=s(3700);let et=ee.fC,es=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(ee.aV,{ref:t,className:h("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",s),...r})});es.displayName=ee.aV.displayName;let ea=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(ee.xz,{ref:t,className:h("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",s),...r})});ea.displayName=ee.xz.displayName;let er=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(ee.VY,{ref:t,className:h("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",s),...r})});er.displayName=ee.VY.displayName;let en=e=>{let{children:t,...s}=e;return(0,a.jsx)("div",{...s,children:t})},el=e=>{let{children:t,...s}=e;return(0,a.jsx)("div",{...s,children:t})},ei=r.forwardRef((e,t)=>{let{className:s,asChild:r,children:n,...l}=e;return(0,a.jsx)(r?"span":"div",{ref:t,className:h("inline-block",s),...l,children:n})});ei.displayName="TooltipTrigger";let eo=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("div",{ref:t,className:h("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95",s),...r})});eo.displayName="TooltipContent";let ec=(0,g.j)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function ed(e){let{className:t,variant:s,...r}=e;return(0,a.jsx)("div",{className:h(ec({variant:s}),t),...r})}var em=s(14123),eu=s.n(em),eh=s(46100);let ex=eh.fC;eh.xz;let eg=e=>{let{children:t,...s}=e;return(0,a.jsx)(eh.h_,{...s,children:(0,a.jsx)("div",{className:"fixed inset-0 z-50 flex items-start justify-center sm:items-center",children:t})})};eg.displayName=eh.h_.displayName;let ep=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(eh.aV,{ref:t,className:h("fixed inset-0 z-50 bg-background/80 backdrop-blur-sm transition-all duration-100 data-[state=closed]:animate-out data-[state=closed]:fade-out data-[state=open]:fade-in",s),...r})});ep.displayName=eh.aV.displayName;let ef=r.forwardRef((e,t)=>{let{className:s,children:r,...n}=e;return(0,a.jsxs)(eg,{children:[(0,a.jsx)(ep,{}),(0,a.jsxs)(eh.VY,{ref:t,className:h("fixed z-50 grid w-full gap-4 rounded-b-lg border bg-background p-6 shadow-lg animate-in data-[state=open]:fade-in-90 data-[state=open]:slide-in-from-bottom-10 sm:max-w-lg sm:rounded-lg sm:zoom-in-90 data-[state=open]:sm:slide-in-from-bottom-0",s),...n,children:[r,(0,a.jsxs)(eh.x8,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,a.jsx)(K.Z,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})});ef.displayName=eh.VY.displayName;let eb=e=>{let{className:t,...s}=e;return(0,a.jsx)("div",{className:h("flex flex-col space-y-1.5 text-center sm:text-left",t),...s})};eb.displayName="DialogHeader";let ey=e=>{let{className:t,...s}=e;return(0,a.jsx)("div",{className:h("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...s})};ey.displayName="DialogFooter";let ev=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(eh.Dx,{ref:t,className:h("text-lg font-semibold leading-none tracking-tight",s),...r})});ev.displayName=eh.Dx.displayName;let ej=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(eh.dk,{ref:t,className:h("text-sm text-muted-foreground",s),...r})});function ek(e){let{open:t,onOpenChange:s}=e;return(0,a.jsx)(ex,{open:t,onOpenChange:s,children:(0,a.jsxs)(ef,{className:"sm:max-w-md",children:[(0,a.jsxs)(eb,{children:[(0,a.jsxs)(ev,{className:"flex items-center gap-2",children:[(0,a.jsx)(B.Z,{className:"h-5 w-5"}),"Keyboard Shortcuts"]}),(0,a.jsx)(ej,{children:"Use these keyboard shortcuts to quickly navigate and use the application."})]}),(0,a.jsx)("div",{className:"py-4",children:(0,a.jsx)("div",{className:"space-y-2",children:[{keys:["Ctrl","Enter"],description:"Submit for marking"},{keys:["Ctrl","Shift","R"],description:"Reset form"},{keys:["Ctrl","."],description:"Toggle advanced options"},{keys:["Ctrl","/"],description:"Toggle help guide"},{keys:["Ctrl","K"],description:"Open shortcuts dialog"},{keys:["Tab"],description:"Navigate between fields"},{keys:["Esc"],description:"Close dialogs"}].map((e,t)=>(0,a.jsxs)("div",{className:"flex justify-between items-center py-1 border-b border-gray-100 dark:border-gray-800",children:[(0,a.jsx)("span",{className:"text-sm",children:e.description}),(0,a.jsx)("div",{className:"flex items-center gap-1",children:e.keys.map((t,s)=>(0,a.jsxs)("span",{children:[(0,a.jsx)("kbd",{className:"px-2 py-1 bg-gray-100 dark:bg-gray-800 text-gray-800 dark:text-gray-200 rounded text-xs",children:t}),s<e.keys.length-1&&(0,a.jsx)("span",{className:"mx-1 text-gray-400",children:"+"})]},s))})]},t))})}),(0,a.jsx)(ey,{children:(0,a.jsx)(f,{onClick:()=>s(!1),children:"Close"})})]})})}ej.displayName=eh.dk.displayName;var ew=s(78867),eN=s(89345),eS=s(42351),eC=s(79219),eE=s(92735),eT=s(17625),eA=s(5273),eP=s(40519);let eR=eA.fC,eI=eA.xz;eA.ZA,eA.Uv,eA.Tr,eA.Ee,r.forwardRef((e,t)=>{let{className:s,inset:r,children:n,...l}=e;return(0,a.jsxs)(eA.fF,{ref:t,className:h("flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent",r&&"pl-8",s),...l,children:[n,(0,a.jsx)(Q.Z,{className:"ml-auto h-4 w-4"})]})}).displayName=eA.fF.displayName,r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(eA.tu,{ref:t,className:h("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md animate-in slide-in-from-left-1",s),...r})}).displayName=eA.tu.displayName;let ez=r.forwardRef((e,t)=>{let{className:s,sideOffset:r=4,...n}=e;return(0,a.jsx)(eA.Uv,{children:(0,a.jsx)(eA.VY,{ref:t,sideOffset:r,className:h("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md animate-in data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",s),...n})})});ez.displayName=eA.VY.displayName;let eF=r.forwardRef((e,t)=>{let{className:s,inset:r,...n}=e;return(0,a.jsx)(eA.ck,{ref:t,className:h("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",r&&"pl-8",s),...n})});eF.displayName=eA.ck.displayName,r.forwardRef((e,t)=>{let{className:s,children:r,checked:n,...l}=e;return(0,a.jsxs)(eA.oC,{ref:t,className:h("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",s),checked:n,...l,children:[(0,a.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,a.jsx)(eA.wU,{children:(0,a.jsx)(C.Z,{className:"h-4 w-4"})})}),r]})}).displayName=eA.oC.displayName,r.forwardRef((e,t)=>{let{className:s,children:r,...n}=e;return(0,a.jsxs)(eA.Rk,{ref:t,className:h("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",s),...n,children:[(0,a.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,a.jsx)(eA.wU,{children:(0,a.jsx)(eP.Z,{className:"h-2 w-2 fill-current"})})}),r]})}).displayName=eA.Rk.displayName;let e_=r.forwardRef((e,t)=>{let{className:s,inset:r,...n}=e;return(0,a.jsx)(eA.__,{ref:t,className:h("px-2 py-1.5 text-sm font-semibold",r&&"pl-8",s),...n})});e_.displayName=eA.__.displayName;let eZ=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(eA.Z0,{ref:t,className:h("-mx-1 my-1 h-px bg-muted",s),...r})});eZ.displayName=eA.Z0.displayName;var eq=s(23895);let eD=(0,g.j)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),eG=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(eq.f,{ref:t,className:h(eD(),s),...r})});eG.displayName=eq.f.displayName;let eO=r.forwardRef((e,t)=>{let{className:s,type:r,...n}=e;return(0,a.jsx)("input",{type:r,className:h("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",s),ref:t,...n})});eO.displayName="Input";let eM=(e,t)=>{let s=(0,r.useCallback)(async t=>{if(!t||t.length<20)return null;try{for(let[s,a]of Object.entries(e))for(let e of a)if(t.toLowerCase().includes(e.toLowerCase()))return s;return null}catch(e){return console.error("Subject classification error:",e),null}},[e]),a=(0,r.useRef)(null);return(0,r.useEffect)(()=>(a.current=eu()(async(e,a,r,n,l,i,o)=>{if(t)return;let c=await s(e);if(c&&c!==a&&!r.current){var d,m;let e=(null===(d=n.find(e=>e.value===a))||void 0===d?void 0:d.label)||"",t=(null===(m=n.find(e=>e.value===c))||void 0===m?void 0:m.label)||"";l(c),i(c),o({message:"Subject automatically detected as ".concat(t),detail:e?"Changed from ".concat(e):null,icon:"detection"}),setTimeout(()=>o(null),3e3)}},1e3),()=>{a.current&&a.current.cancel()}),[s,t,e]),{classifySubjectAI:s,debouncedClassifySubject:(0,r.useCallback)(function(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];if(a.current)return a.current(...t)},[])}},eU=e=>({checkBackendStatus:(0,r.useCallback)(async t=>{try{if(window.location.hostname.includes("github.io")||"beenycool.github.io"===window.location.hostname)return console.log("Running on GitHub Pages - simulating online status for UI rendering"),window.BACKEND_STATUS={status:"online",lastChecked:new Date().toLocaleTimeString(),isGitHubPages:!0},{ok:!0,data:{status:"ok",openaiClient:!0,apiKeyConfigured:!0,isGitHubPages:!0},status:"online"};let s=0;for(;s<=3;)try{let s=new AbortController,a=setTimeout(()=>s.abort(),12e3);console.log("Checking backend health at ".concat(e,"/api/health"));let r=await fetch("".concat(e,"/api/health?timestamp=").concat(Date.now()),{method:"GET",signal:s.signal,mode:"cors",headers:{"Cache-Control":"no-cache, no-store, must-revalidate",Pragma:"no-cache",Expires:"0"}});if(clearTimeout(a),!r.ok)throw Error("Backend health check failed: ".concat(r.status));let n=await r.json();if(console.log("Backend health check data:",n),!0!==n.openaiClient||!0!==n.apiKeyConfigured)return{ok:!1,error:"The backend API service is not properly configured. Please try again later.",status:"error",data:n};if(t&&"google/gemini-2.5-pro-exp-03-25"===t&&!0===n.rateLimited)return{ok:!1,error:"Gemini 2.5 Pro is rate limited. Please try again in a minute or choose another model.",status:"rate_limited",data:n};return{ok:!0,data:n,status:"online"}}catch(t){if(3===s)throw t;let e=2e3*(s+1);console.log("Retry attempt ".concat(s+1," for backend health check in ").concat(e,"ms")),await new Promise(t=>setTimeout(t,e)),s++}}catch(s){console.error("Backend health check failed:",s);let e=s.message,t="error";return"AbortError"===s.name?(e="Backend did not respond in time. Render's free tier servers may take up to 50 seconds to wake up.",t="timeout"):(s.message.includes("Failed to fetch")||s.message.includes("NetworkError"))&&(e="Network connection to backend failed. Please check your internet connection and try again in a moment.",t="network"),{ok:!1,error:e,status:t}}},[e])});var eK=s(85929),eB=s(97226),eL=s(25922);function eV(){let{setTheme:e,theme:t}=(0,eL.F)();return(0,a.jsx)(en,{children:(0,a.jsxs)(el,{children:[(0,a.jsx)(ei,{asChild:!0,children:(0,a.jsxs)(f,{variant:"ghost",size:"icon",onClick:()=>e("light"===t?"dark":"light"),className:"h-9 w-9 rounded-full",children:[(0,a.jsx)(eK.Z,{className:"h-4 w-4 rotate-0 scale-100 transition-all dark:-rotate-90 dark:scale-0"}),(0,a.jsx)(eB.Z,{className:"absolute h-4 w-4 rotate-90 scale-0 transition-all dark:rotate-0 dark:scale-100"}),(0,a.jsx)("span",{className:"sr-only",children:"Switch theme"})]})}),(0,a.jsx)(eo,{children:(0,a.jsx)("p",{children:"Light/Dark"})})]})})}let eH="https://beenycool-github-io.onrender.com";console.log("Using API URL:",eH),window.BACKEND_STATUS=window.BACKEND_STATUS||{status:"checking",lastChecked:null};let eQ=[{value:"english",label:"English"},{value:"maths",label:"Maths"},{value:"science",label:"Science"},{value:"history",label:"History"},{value:"geography",label:"Geography"},{value:"computerScience",label:"Computer Science"},{value:"businessStudies",label:"Business Studies"}],eY=[{value:"aqa",label:"AQA"},{value:"edexcel",label:"Edexcel"},{value:"ocr",label:"OCR"},{value:"wjec",label:"WJEC"}],eJ=[{value:"student",label:"Student"},{value:"teacher",label:"Teacher"}],eW=[{value:"deepseek/deepseek-r1:free",label:"Thinking Model (takes longer)",description:"More thorough reasoning process"},{value:"deepseek/deepseek-chat-v3-0324:free",label:"Good All-Rounder",description:"Balanced speed and quality"},{value:"google/gemini-2.0-flash-exp:free",label:"Fast Response",description:"Quick responses, suitable for shorter answers"}],e$={english:["shakespeare","poem","poetry","novel","character","theme","literature"],maths:["equation","solve","calculate","algebra","geometry","trigonometry","formula"],science:["experiment","hypothesis","cell","atom","energy","physics","chemistry","biology"],history:["war","battle","king","queen","century","revolution","empire","historical"],geography:["map","climate","population","country","city","river","mountain","ecosystem"],computerScience:["programming","algorithm","code","computer","software","hardware"],businessStudies:["business","market","finance","profit","enterprise","economy"]},eX={english:{aqa:[{value:"general",label:"General Assessment"},{value:"paper1q3",label:"Paper 1, Question 3 (Structure)"},{value:"paper1q4",label:"Paper 1, Question 4 (Evaluation)"},{value:"paper2q2",label:"Paper 2, Question 2 (Summary)"},{value:"paper2q5",label:"Paper 2, Question 5 (Writing)"}],edexcel:[{value:"general",label:"General Assessment"}],ocr:[{value:"general",label:"General Assessment"}],wjec:[{value:"general",label:"General Assessment"}]}},e0=e=>{let{onStatusChange:t}=e,[s,n]=(0,r.useState)("checking"),[l,i]=(0,r.useState)(null),[o,c]=(0,r.useState)(null),[d,m]=(0,r.useState)(!1),[u,h]=(0,r.useState)(0),[x,g]=(0,r.useState)(0),p=(0,r.useRef)(null),{checkBackendStatus:b}=eU(eH),y=(0,r.useCallback)(async()=>{try{n("checking");let e=await b();if(c(new Date().toLocaleTimeString()),!e.ok){"timeout"===e.status?(n("waking_up"),i("Server is waking up..."),m(!0),h(0),clearInterval(p.current),p.current=setInterval(()=>{h(e=>{let t=e+2;return t>=100?(clearInterval(p.current),100):t})},1e3),setTimeout(()=>{y()},1e4)):(n(e.status||"error"),i(e.error),m(!1),clearInterval(p.current)),t&&t(e.status||"error",e.data),window.BACKEND_STATUS={status:e.status||"error",lastChecked:new Date().toLocaleTimeString()};return}n("online"),i(null),m(!1),g(0),clearInterval(p.current),window.BACKEND_STATUS={status:"online",lastChecked:new Date().toLocaleTimeString()},t&&t("online",e.data)}catch(e){console.error("Backend status check failed:",e),"AbortError"===e.name?(n("timeout"),i("Connection timed out")):(n("error"),i(e.message)),window.BACKEND_STATUS={status:"AbortError"===e.name?"timeout":"error",lastChecked:new Date().toLocaleTimeString(),error:e.message},t&&t("AbortError"===e.name?"timeout":"error")}},[b,t]);(0,r.useEffect)(()=>{y();let e=setInterval(()=>{y()},6e4);return()=>{clearInterval(e),clearInterval(p.current)}},[y]);let v=(0,r.useCallback)(()=>{y()},[y]);return"online"===s?null:(0,a.jsxs)("div",{className:"mb-4 p-4 bg-amber-50 dark:bg-amber-900/30 border border-amber-200 dark:border-amber-800 rounded-lg shadow-sm",children:[(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4",children:[(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(q.Z,{className:"h-5 w-5 text-amber-500 mr-2 flex-shrink-0"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"font-medium text-amber-800 dark:text-amber-300",children:"waking_up"===s?"Backend Server is Starting Up":"Backend Server is Offline"}),(0,a.jsx)("p",{className:"text-sm text-amber-700 dark:text-amber-400 mt-1",children:"waking_up"===s?"This can take up to 30-60 seconds as our server is hosted on a free tier which goes to sleep after inactivity.":"The backend server is currently offline. Click the button to wake it up."})]})]}),(0,a.jsx)("div",{className:"w-full sm:w-auto",children:(0,a.jsx)(f,{onClick:v,disabled:d&&u<95,className:"w-full sm:w-auto bg-amber-500 hover:bg-amber-600 text-white",children:d?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(D.Z,{className:"mr-2 h-4 w-4 animate-spin"}),"Waking Up... (",Math.min(u,95),"%)"]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(G.Z,{className:"mr-2 h-4 w-4"}),x>0?"Try Again":"Wake Up API"]})})})]}),d&&(0,a.jsx)("div",{className:"mt-3",children:(0,a.jsx)("div",{className:"w-full bg-amber-200 dark:bg-amber-800 rounded-full h-2.5",children:(0,a.jsx)("div",{className:"bg-amber-500 h-2.5 rounded-full transition-all duration-300",style:{width:"".concat(Math.min(u,95),"%")}})})}),l&&(0,a.jsxs)("p",{className:"mt-2 text-xs text-amber-700 dark:text-amber-400",children:["Details: ",l]}),(0,a.jsx)("p",{className:"mt-3 text-xs text-amber-700 dark:text-amber-400 italic",children:'The backend API is hosted on Render\'s free tier, which automatically spins down after periods of inactivity to save resources. This is why it may take up to a minute to "wake up" when you first visit the site.'})]})},e2=e=>{var t,s,r,n;let{success:l,error:i}=e;if(!l&&!i)return null;if(l)return(0,a.jsxs)(W,{className:"mb-4 bg-green-50 dark:bg-green-950 border-green-200 dark:border-green-900",children:[(0,a.jsx)(O.Z,{className:"h-4 w-4 text-green-600 dark:text-green-400"}),(0,a.jsx)($,{className:"text-green-800 dark:text-green-300 ml-2",children:"Success"}),(0,a.jsx)(X,{className:"text-green-700 dark:text-green-400 ml-2",children:l.message})]});let o="api_error"===i.type||(null===(t=i.message)||void 0===t?void 0:t.includes("API"))||(null===(s=i.message)||void 0===s?void 0:s.includes("backend")),c=(null===(r=i.message)||void 0===r?void 0:r.includes("rate limit"))||(null===(n=i.message)||void 0===n?void 0:n.toLowerCase().includes("too many requests"));return(0,a.jsxs)(W,{className:"mb-4 ".concat(c?"bg-amber-50 dark:bg-amber-950 border-amber-200 dark:border-amber-900":"bg-red-50 dark:bg-red-950 border-red-200 dark:border-red-900"),children:[c?(0,a.jsx)(q.Z,{className:"h-4 w-4 text-amber-600 dark:text-amber-400"}):(0,a.jsx)(q.Z,{className:"h-4 w-4 text-red-600 dark:text-red-400"}),(0,a.jsxs)($,{className:"".concat(c?"text-amber-800 dark:text-amber-300":"text-red-800 dark:text-red-300"," ml-2 flex items-center gap-2"),children:[o?"API Error":c?"Rate Limited":"Error",i.code&&(0,a.jsxs)("span",{className:"text-xs opacity-75",children:["(",i.code,")"]})]}),(0,a.jsxs)(X,{className:"".concat(c?"text-amber-700 dark:text-amber-400":"text-red-700 dark:text-red-400"," ml-2 flex flex-col gap-2"),children:[(0,a.jsx)("span",{children:i.message}),o&&(0,a.jsx)("span",{className:"text-sm",children:"The backend API service may be offline or starting up. This is normal as we use a free hosting service that goes to sleep after periods of inactivity."}),i.retry&&(0,a.jsxs)("div",{className:"flex items-center gap-2 mt-1",children:[(0,a.jsxs)(f,{size:"sm",variant:"outline",className:"text-xs h-7 ".concat(c?"border-amber-200 dark:border-amber-800 hover:bg-amber-100 dark:hover:bg-amber-900 text-amber-800 dark:text-amber-300":"border-red-200 dark:border-red-800 hover:bg-red-100 dark:hover:bg-red-900 text-red-800 dark:text-red-300"),onClick:!0===i.retry?()=>window.location.reload():i.retry,children:[(0,a.jsx)(M.Z,{className:"h-3 w-3 mr-1"})," Try Again"]}),o&&(0,a.jsx)("span",{className:"text-xs opacity-75",children:"You may need to wait 30-60 seconds for the backend to start up"})]})]})]})},e1=e=>{let{loading:t,progress:s}=e;return t?(0,a.jsx)("div",{className:"absolute inset-0 bg-black/5 dark:bg-black/20 backdrop-blur-[1px] flex items-center justify-center z-50 rounded-lg",children:(0,a.jsxs)("div",{className:"bg-white dark:bg-gray-900 p-4 rounded-lg shadow-lg flex flex-col items-center gap-2 min-w-[200px]",children:[(0,a.jsx)(D.Z,{className:"h-6 w-6 animate-spin text-primary"}),(0,a.jsx)("p",{className:"text-sm font-medium",children:s||"Processing..."})]})}):null},e4=e=>{let{children:t}=e;return(0,a.jsx)(i.UG,{remarkPlugins:[o.Z],rehypePlugins:[c.Z],components:{h1:e=>{let{node:t,...s}=e;return(0,a.jsx)("h1",{className:"text-xl my-3 font-bold",...s})},h2:e=>{let{node:t,...s}=e;return(0,a.jsx)("h2",{className:"text-lg my-3 font-bold",...s})},h3:e=>{let{node:t,...s}=e;return(0,a.jsx)("h3",{className:"text-base my-2.5 font-semibold",...s})},p:e=>{let{node:t,...s}=e;return(0,a.jsx)("p",{className:"my-2",...s})},ul:e=>{let{node:t,...s}=e;return(0,a.jsx)("ul",{className:"list-disc pl-5 my-2",...s})},ol:e=>{let{node:t,...s}=e;return(0,a.jsx)("ol",{className:"list-decimal pl-5 my-2",...s})},li:e=>{let{node:t,...s}=e;return(0,a.jsx)("li",{className:"ml-2 my-1",...s})},strong:e=>{let{node:t,...s}=e;return(0,a.jsx)("strong",{className:"font-bold",...s})},em:e=>{let{node:t,...s}=e;return(0,a.jsx)("em",{className:"italic",...s})}},children:t})},e3=(e,t,s)=>{let a=e.replace(/\[GRADE:\d\]/g,"");switch(t){case"clipboard":return navigator.clipboard.writeText(a),"Feedback copied to clipboard!";case"email":let r=encodeURIComponent("GCSE Grade ".concat(s," Feedback")),n=encodeURIComponent(a);return window.open("mailto:?subject=".concat(r,"&body=").concat(n)),"Email client opened";case"twitter":let l=encodeURIComponent("I received a Grade ".concat(s," on my GCSE assessment! #GCSE #Education"));return window.open("https://twitter.com/intent/tweet?text=".concat(l)),"Twitter share opened";case"facebook":return window.open("https://www.facebook.com/sharer/sharer.php?u=".concat(encodeURIComponent(window.location.href))),"Facebook share opened";default:return""}},e5=async(e,t)=>{try{let a=await s.e(457).then(s.t.bind(s,24457,23)),r=await s.e(501).then(s.bind(s,43501)),n=a.default,l=r.default,i=e.current;if(!i)return;let o=await n(i,{scale:2,useCORS:!0,logging:!1}),c=o.toDataURL("image/png"),d=new l("p","mm","a4"),m=d.internal.pageSize.getWidth(),u=d.internal.pageSize.getHeight(),h=o.width,x=o.height,g=Math.min(m/h,u/x);return d.addImage(c,"PNG",(m-h*g)/2,0,h*g,x*g),d.save("GCSE_Grade".concat(t,"_Feedback.pdf")),"Feedback saved as PDF"}catch(e){console.error("Error saving PDF:",e),alert("Could not generate PDF. Please try again or use another method to save the feedback.")}},e6=e=>{try{let t=window.open("","_blank"),s=e.current.innerHTML;return t.document.write('\n      <!DOCTYPE html>\n      <html>\n        <head>\n          <title>GCSE Assessment Feedback</title>\n          <style>\n            body { font-family: Arial, sans-serif; padding: 20px; }\n            .feedback-container { max-width: 800px; margin: 0 auto; }\n            h1, h2, h3 { color: #333; }\n            ul { padding-left: 20px; }\n            li { margin-bottom: 5px; }\n            .grade { display: inline-block; width: 40px; height: 40px; \n                    background: #f0f0f0; border-radius: 50%; text-align: center; \n                    line-height: 40px; font-weight: bold; font-size: 20px; \n                    margin: 10px 0; }\n          </style>\n        </head>\n        <body>\n          <div class="feedback-container">\n            <h1>GCSE Assessment Feedback</h1>\n            '.concat(s,"\n          </div>\n          <script>\n            window.onload = function() { window.print(); window.close(); }\n          </script>\n        </body>\n      </html>\n    ")),t.document.close(),"Print dialog opened"}catch(e){console.error("Error printing feedback:",e),alert("Could not open print dialog. Please try again or use another method to save the feedback.")}},e8=e=>{let{feedback:t,grade:s,modelName:l}=e,i=(0,r.useRef)(null),[o,c]=(0,r.useState)(null),d=e=>{c(e3(t,e,s)),setTimeout(()=>c(null),2e3)},m=async()=>{c(await e5(i,s)),setTimeout(()=>c(null),2e3)};return(0,a.jsxs)("div",{className:"relative",children:[o&&(0,a.jsx)(n.E.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"absolute -top-10 left-1/2 transform -translate-x-1/2 bg-black/80 text-white px-3 py-1.5 rounded text-sm z-10",children:o}),(0,a.jsxs)("div",{className:"flex justify-between items-center mb-3",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[s&&(0,a.jsx)("div",{className:"inline-flex items-center justify-center h-10 w-10 bg-gradient-to-br from-indigo-600 to-purple-600 dark:from-indigo-500 dark:to-purple-500 text-white font-bold rounded-full shadow-md",children:s}),(0,a.jsxs)("h3",{className:"text-lg font-semibold text-gray-800 dark:text-gray-200",children:["Feedback",(0,a.jsxs)("span",{className:"ml-2 text-xs text-gray-500 dark:text-gray-400",children:["by ",l]})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,a.jsx)(en,{children:(0,a.jsxs)(el,{children:[(0,a.jsx)(ei,{asChild:!0,children:(0,a.jsx)(f,{variant:"ghost",size:"sm",onClick:()=>window.location.reload(),className:"h-8 w-8 p-0 rounded-full",children:(0,a.jsx)(M.Z,{className:"h-4 w-4 text-gray-600 dark:text-gray-400"})})}),(0,a.jsx)(eo,{children:(0,a.jsx)("p",{children:"Try a different model"})})]})}),(0,a.jsxs)(eR,{children:[(0,a.jsx)(en,{children:(0,a.jsxs)(el,{children:[(0,a.jsx)(ei,{asChild:!0,children:(0,a.jsx)(eI,{asChild:!0,children:(0,a.jsx)(f,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0 rounded-full",children:(0,a.jsx)(U.Z,{className:"h-4 w-4 text-gray-600 dark:text-gray-400"})})})}),(0,a.jsx)(eo,{children:(0,a.jsx)("p",{children:"Share feedback"})})]})}),(0,a.jsxs)(ez,{align:"end",className:"w-56",children:[(0,a.jsx)(e_,{children:"Share Feedback"}),(0,a.jsx)(eZ,{}),(0,a.jsxs)(eF,{onClick:()=>d("clipboard"),children:[(0,a.jsx)(ew.Z,{className:"mr-2 h-4 w-4"}),(0,a.jsx)("span",{children:"Copy to clipboard"})]}),(0,a.jsxs)(eF,{onClick:()=>d("email"),children:[(0,a.jsx)(eN.Z,{className:"mr-2 h-4 w-4"}),(0,a.jsx)("span",{children:"Share via email"})]}),(0,a.jsxs)(eF,{onClick:()=>d("twitter"),children:[(0,a.jsx)(eS.Z,{className:"mr-2 h-4 w-4"}),(0,a.jsx)("span",{children:"Share on Twitter"})]}),(0,a.jsxs)(eF,{onClick:()=>d("facebook"),children:[(0,a.jsx)(eC.Z,{className:"mr-2 h-4 w-4"}),(0,a.jsx)("span",{children:"Share on Facebook"})]}),(0,a.jsx)(eZ,{}),(0,a.jsxs)(eF,{onClick:m,children:[(0,a.jsx)(eE.Z,{className:"mr-2 h-4 w-4"}),(0,a.jsx)("span",{children:"Save as PDF"})]}),(0,a.jsxs)(eF,{onClick:()=>{c(e6(i)),setTimeout(()=>c(null),2e3)},children:[(0,a.jsx)(eT.Z,{className:"mr-2 h-4 w-4"}),(0,a.jsx)("span",{children:"Print feedback"})]})]})]})]})]}),(0,a.jsx)("div",{ref:i,className:"prose prose-sm dark:prose-invert prose-p:my-2 prose-h1:text-xl prose-h1:my-3 prose-h2:text-lg prose-h2:my-3 prose-h3:text-base prose-h3:font-semibold prose-h3:my-2.5 max-w-none bg-white dark:bg-gray-900 p-4 rounded-lg shadow-sm border border-gray-100 dark:border-gray-800",children:(0,a.jsx)(e4,{children:t})})]})},e9=e=>{let{onClose:t}=e;return(0,a.jsxs)("div",{className:"mb-6 bg-white dark:bg-gray-900 rounded-lg border shadow-sm overflow-hidden",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center bg-blue-50 dark:bg-blue-950 border-b border-blue-100 dark:border-blue-900 p-3",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("div",{className:"text-lg font-semibold text-blue-800 dark:text-blue-300",children:"Quick Guide"}),(0,a.jsx)("div",{className:"text-sm text-blue-600 dark:text-blue-400",children:"How to use the GCSE AI Marker"})]}),(0,a.jsxs)(f,{variant:"ghost",size:"sm",className:"text-blue-700 dark:text-blue-300 hover:bg-blue-100 dark:hover:bg-blue-900 h-8 w-8 p-0 rounded-full",onClick:t,children:[(0,a.jsx)(K.Z,{className:"h-5 w-5"}),(0,a.jsx)("span",{className:"sr-only",children:"Close"})]})]}),(0,a.jsx)("div",{className:"p-4",children:(0,a.jsxs)("ol",{className:"space-y-2",children:[(0,a.jsxs)("li",{className:"flex gap-3",children:[(0,a.jsx)("div",{className:"flex-shrink-0 flex items-center justify-center h-6 w-6 rounded-full bg-blue-100 dark:bg-blue-900 text-blue-800 dark:text-blue-300 font-medium",children:"1"}),(0,a.jsx)("p",{className:"text-gray-700 dark:text-gray-300",children:"Enter your question and answer in the text boxes."})]}),(0,a.jsxs)("li",{className:"flex gap-3",children:[(0,a.jsx)("div",{className:"flex-shrink-0 flex items-center justify-center h-6 w-6 rounded-full bg-blue-100 dark:bg-blue-900 text-blue-800 dark:text-blue-300 font-medium",children:"2"}),(0,a.jsx)("p",{className:"text-gray-700 dark:text-gray-300",children:"Select the subject, exam board, and question type."})]}),(0,a.jsxs)("li",{className:"flex gap-3",children:[(0,a.jsx)("div",{className:"flex-shrink-0 flex items-center justify-center h-6 w-6 rounded-full bg-blue-100 dark:bg-blue-900 text-blue-800 dark:text-blue-300 font-medium",children:"3"}),(0,a.jsx)("p",{className:"text-gray-700 dark:text-gray-300",children:'Click "Mark Answer" to get AI feedback.'})]}),(0,a.jsxs)("li",{className:"flex gap-3",children:[(0,a.jsx)("div",{className:"flex-shrink-0 flex items-center justify-center h-6 w-6 rounded-full bg-blue-100 dark:bg-blue-900 text-blue-800 dark:text-blue-300 font-medium",children:"4"}),(0,a.jsx)("p",{className:"text-gray-700 dark:text-gray-300",children:"Review the feedback and grade provided."})]}),(0,a.jsxs)("li",{className:"flex gap-3",children:[(0,a.jsx)("div",{className:"flex-shrink-0 flex items-center justify-center h-6 w-6 rounded-full bg-blue-100 dark:bg-blue-900 text-blue-800 dark:text-blue-300 font-medium",children:"5"}),(0,a.jsx)("p",{className:"text-gray-700 dark:text-gray-300",children:"Optionally save, share or print your feedback."})]})]})})]})};var e7=()=>{var e,t;console.log("AIMarker component is rendering",{window:window.location.hostname});let[s,i]=(0,r.useState)(""),[o,c]=(0,r.useState)(""),[m,u]=(0,r.useState)("english"),[h,x]=(0,r.useState)("aqa"),[g,p]=(0,r.useState)("general"),[N,C]=(0,r.useState)("student"),[_,Z]=(0,r.useState)(""),[U,J]=(0,r.useState)(null),[W,$]=(0,r.useState)("answer"),[X,ee]=(0,r.useState)(""),[ec,em]=(0,r.useState)(!1),[eu,eh]=(0,r.useState)([]),[ex,eg]=(0,r.useState)(eQ),ep=(0,r.useRef)(null),[ef,eb]=(0,r.useState)(""),[ey,ev]=(0,r.useState)(""),[ej,ew]=(0,r.useState)(""),[eN,eS]=(0,r.useState)(""),[eC,eE]=(0,r.useState)(!1),[eT,eA]=(0,r.useState)(!1),[eP,eR]=(0,r.useState)(!1),[eI,ez]=(0,r.useState)(!1),[eF,e_]=(0,r.useState)(!1),[eZ,eq]=(0,r.useState)(""),[eD,eK]=(0,r.useState)(""),[eB,eL]=(0,r.useState)(null),[e4,e3]=(0,r.useState)(null),[e5,e6]=(0,r.useState)(null),[e7,te]=(0,r.useState)(null),[tt,ts]=(0,r.useState)(""),[ta,tr]=(0,r.useState)(null),[tn,tl]=(0,r.useState)(0),[ti,to]=(0,r.useState)(0),[tc,td]=(0,r.useState)(new Date().toDateString()),[tm,tu]=(0,r.useState)("deepseek/deepseek-chat-v3-0324:free"),[th,tx]=(0,r.useState)(!1),[tg,tp]=(0,r.useState)(!1),[tf,tb]=(0,r.useState)(!1),[ty,tv]=(0,r.useState)(null),[tj,tk]=(0,r.useState)(null),[tw,tN]=(0,r.useState)(null),[tS,tC]=(0,r.useState)(null),[tE,tT]=(0,r.useState)(null),tA=(0,r.useRef)(!1),tP=(0,r.useRef)("checking"),[tR,tI]=(0,r.useState)(!1),tz=(0,r.useCallback)((e,t)=>{console.log("Backend status changed:",e,t),tP.current=e,tI(e=>!e),"offline"===e||"error"===e?tp(!0):tp(!1)},[]),{classifySubjectAI:tF,debouncedClassifySubject:t_}=eM(e$,eF),{checkBackendStatus:tZ}=eU(eH);(0,r.useEffect)(()=>{{let e=window.location.hostname.includes("github.io")||"beenycool.github.io"===window.location.hostname;eA(e),e&&(console.log("Running on GitHub Pages - simulating online status for UI rendering"),tP.current="online",tI(e=>!e))}},[eA]);let tq=(0,r.useCallback)(async()=>{let e,t;if(eq(""),eK(""),eL(null),e3(null),eS(""),!o){eL({type:"validation",message:"Please enter an answer to be marked"});return}e_(!0),e3({message:"Checking backend status..."});let a=await tZ(tm);if(!a.ok){e_(!1),eL({type:"network",message:"Backend connection error: ".concat(a.error,". Render's free tier servers may take up to 50 seconds to wake up after inactivity. Please try again in a minute."),retry:!0});return}let r=Date.now(),n=new Date().toDateString();if(n!==tc&&(to(0),td(n),localStorage.setItem("lastRequestDate",n),localStorage.setItem("dailyRequests","0")),"google/gemini-2.5-pro-exp-03-25"===tm&&r-tn<6e4){e_(!1),eL({type:"rate_limit",message:"Gemini 2.5 Pro is limited to 1 request per minute. Please wait or select a different model."});return}if("google/gemini-2.5-pro-exp-03-25"!==tm&&r-tn<1e4){e_(!1),eL({type:"rate_limit",message:"Please wait at least 10 seconds between requests"});return}let l=()=>{let e=localStorage.getItem("requestTokens"),t=new Date().toDateString(),s=e?JSON.parse(e):{count:500,lastReset:t};return s.lastReset!==t&&(s={count:500,lastReset:t}),localStorage.setItem("requestTokens",JSON.stringify(s)),s};if(!(()=>{let e=l();return!(e.count<=0)&&(e.count-=1,localStorage.setItem("requestTokens",JSON.stringify(e)),!0)})()){e_(!1),eL({type:"rate_limit",message:"Daily request limit reached (500/day)"});return}let i=(t="You are an experienced GCSE ".concat(m," examiner. Your task is to provide detailed, constructive feedback for ").concat("teacher"===N?"assessment purposes":"student learning"," following these guidelines:\n\n1. ASSESSMENT CRITERIA:\n- Accuracy of content (subject knowledge)\n- Clarity and structure of response\n- Use of evidence/examples\n- Depth of analysis (where applicable)\n- Technical accuracy (spelling, grammar, terminology)\n\n2. FEEDBACK STRUCTURE:\na) Summary of performance (1-2 sentences)\nb) 2-3 specific strengths with examples\nc) 2-3 areas for improvement with ").concat("teacher"===N?"marking criteria":"actionable suggestions","\nd) One specific ").concat("teacher"===N?"assessment note":'"next step" for the student',"\ne) GCSE grade (9-1) in the format: [GRADE:X] where X is the grade number\n\n3. TONE & STYLE:\n- ").concat("teacher"===N?"Professional and assessment-focused":"Approachable and encouraging",'\n- Specific praise ("Excellent use of terminology when...")\n- Constructive criticism ').concat("teacher"===N?'("This meets level 3 criteria because...")':'("Consider expanding on...")',"\n- Avoid vague statements - always reference the answer"),"maths"===m?t+="\n\n4. MATHEMATICAL NOTATION:\n- Use LaTeX notation for mathematical expressions enclosed in ( ) for inline formulas and as separate blocks for complex formulas\n- Example inline: ( x = \\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a} )\n- Example block:\n$$\nx = \\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a}\n$$\n- Format solutions step-by-step with clear explanations\n- Number equations and reference them in your feedback":t+="\n\n4. SUBJECT-SPECIFIC GUIDANCE:\n".concat(function(e,t){let s={english:{aqa:"- Focus on the use of language, structure and form\n- Evaluate the writer's methods and intentions\n- Consider the social, historical and literary context\n- Reference the text with specific quotations\n- Assessment Objectives: AO1 (ideas & language), AO2 (analysis), AO3 (context), AO4 (evaluation)",edexcel:"- Analyze how writers use language and structure to achieve effects\n- Comment on the influence of contextual factors\n- Use subject terminology accurately\n- Support points with precise references to the text",ocr:"- Evaluate writers' choices of language, form and structure\n- Consider the impact on readers\n- Demonstrate understanding of context\n- Use a range of appropriate terminology",wjec:"- Analyze how meanings are shaped through language, form and structure\n- Show understanding of the relationship between texts and contexts\n- Use relevant terminology\n- Support interpretations with specific references"},maths:{general:"- Check for correct application of mathematical procedures\n- Evaluate the clarity of working out\n- Consider alternative methods/solutions\n- Award method marks for correct approaches even with calculation errors\n- Check final answers for accuracy and appropriate rounding"},science:{general:"- Look for scientific accuracy in explanations\n- Check for proper use of technical terminology\n- Consider experimental design quality\n- Evaluate analytical reasoning and critical thinking\n- Assess understanding of scientific principles"},history:{general:"- Evaluate the use of historical evidence\n- Consider different historical interpretations\n- Assess understanding of key historical concepts\n- Look for chronological understanding\n- Check for balanced argumentation"},geography:{general:"- Check for understanding of physical and human processes\n- Evaluate use of geographical data and case studies\n- Consider sustainability and interconnection concepts\n- Assess the quality of geographical analysis\n- Look for appropriate use of maps and diagrams"},computerScience:{general:"- Evaluate understanding of computing principles\n- Check for logical problem-solving approaches\n- Assess code quality and algorithm efficiency\n- Consider practical application of theoretical concepts\n- Look for critical understanding of computing systems"},businessStudies:{general:"- Check understanding of business concepts and theories\n- Evaluate analytical and critical thinking\n- Assess application to real business contexts\n- Consider different stakeholder perspectives\n- Look for balanced evaluation of business decisions"}};return s[e]&&s[e][t]?s[e][t]:s[e]&&s[e].general?s[e].general:"- Focus on accurate subject knowledge\n- Consider structure and clarity of response\n- Look for relevant examples and evidence\n- Assess depth of analysis and evaluation\n- Check for appropriate subject-specific terminology"}(m,h)),"deepseek/deepseek-r1:free"===tm&&(t+="\n\n5. THINKING PROCESS:\n- First, analyze the student's answer carefully and identify key strengths and weaknesses\n- For each section of the answer, evaluate both content accuracy and quality of explanation\n- Consider what evidence supports each point you make in your feedback\n- Show your reasoning for the grade assigned by comparing to GCSE standards\n- Mark your thinking process with [THINKING] and your final feedback with [FEEDBACK]"),t);e3({message:"Processing request..."}),tl(r),to(e=>{let t=e+1;return localStorage.setItem("dailyRequests",t.toString()),t});let d=o;if(U){let e=async e=>{if(tx(!0),!e)return null;try{let t=new FileReader,s=await new Promise(s=>{t.onload=()=>s(t.result.split(",")[1]),t.readAsDataURL(e)});e3({message:"Processing your image... Please wait."});let a=await fetch("".concat(eH,"/api/image/extract"),{method:"POST",headers:{"Content-Type":"application/json"},mode:"cors",body:JSON.stringify({image_base64:s})});if(!a.ok)throw Error("Image processing failed: ".concat(a.statusText));let r=(await a.json()).text;return c(e=>e?"".concat(e,"\n").concat(r):r),e3({message:"Image processed successfully! Text has been added to your answer."}),setTimeout(()=>{e3(null)},3e3),r}catch(e){return console.error("Error processing image:",e),eL({type:"image_processing",message:"Failed to process the image. Please try again or enter text manually."}),null}finally{tx(!1),J(null)}},t=await e(U);t&&c(d=o?"".concat(o,"\n").concat(t):t)}let u="Please mark this ".concat(h.toUpperCase()," ").concat(m," GCSE response:\n\nQuestion: ").concat(s,"\n\nAnswer: ").concat(d);_&&(u+="\n\nMark Scheme: ".concat(_)),ef&&(u+="\n\nMarks Available: ".concat(ef)),ey&&(u+="\n\nText Extract: ".concat(ey)),ej&&(u+="\n\nRelevant Material: ".concat(ej)),"english"===m&&"aqa"===h&&"general"!==g&&(u+="\n\nQuestion Type: AQA English ".concat("paper1q3"===g?"Paper 1, Question 3 (Structure Analysis)":"paper1q4"===g?"Paper 1, Question 4 (Evaluation)":"paper2q2"===g?"Paper 2, Question 2 (Summary)":"Paper 2, Question 5 (Writing)"));try{let t=new AbortController,s=setTimeout(()=>t.abort(),15e4);e3({message:"Analyzing answer... (this may take up to 90 seconds)"});let a=0,r=null;for(;a<=2;)try{if("deepseek/deepseek-r1:free"===tm){let e=await fetch("".concat(eH,"/api/chat/completions"),{method:"POST",headers:{"Content-Type":"application/json"},mode:"cors",body:JSON.stringify({model:tm,messages:[{role:"system",content:i+"\nIMPORTANT: Please show your reasoning step-by-step. Prefix your thinking process with '[THINKING]' and your final answer with '[FEEDBACK]'."},{role:"user",content:u}],temperature:.7,max_tokens:4e3,top_p:1,frequency_penalty:0,presence_penalty:0,stream:!0}),signal:t.signal});if(clearTimeout(s),!e.ok){let t=await e.json().catch(()=>({}));throw Error(t.message||"API request failed: ".concat(e.status," ").concat(e.statusText))}let a=e.body.getReader(),r=new TextDecoder("utf-8"),n="",l="",o="",c=!1,d=!1;try{e3({message:"Receiving response stream..."});let e=Date.now();for(;;){let{done:t,value:s}=await a.read();if(t)break;let i=r.decode(s).split("\n\n"),m=Date.now();for(let t of(m-e>3e3&&(e3({message:"Processing response: ".concat(l.length>0?Math.min(99,Math.floor(l.length/50)):0,"%")}),e=m),i))if(t.startsWith("data: ")){let e=t.substring(6);if("[DONE]"===e)continue;try{var x,p;let t=JSON.parse(e),s=(null===(p=t.choices[0])||void 0===p?void 0:null===(x=p.delta)||void 0===x?void 0:x.content)||"";if(n+=s,s.includes("[THINKING]")?(c=!0,d=!1):s.includes("[FEEDBACK]")&&(c=!1,d=!0),c){let e=s.replace("[THINKING]","");l+=e,eS(l)}else if(d){let e=s.replace("[FEEDBACK]","");o+=e}else l+=s,eS(l)}catch(e){console.error("Error parsing stream data:",e)}}}if(!d&&n){let e=n.indexOf("[FEEDBACK]");o=e>=0?n.substring(e+10):n}eq(o.trim());let t=o.match(/\[GRADE:(\d)\]/);t&&t[1]&&eK(t[1])}catch(t){console.error("Streaming error:",t);let e="Error processing response stream.";"AbortError"===t.name?e="Stream timed out. The model is taking too long to respond.":"SyntaxError"===t.name?e="Invalid data received from server. The model might not support streaming.":t.message.includes("network")&&(e="Network error during streaming. Please check your connection."),o||n?(eq(o||n||"Partial feedback received due to streaming error."),eL({type:"streaming",message:"".concat(e," Showing partial results.")})):eL({type:"streaming",message:e+" Please try again or select a different model."})}break}{let a=new Promise((e,t)=>{setTimeout(()=>t(Error("Request timeout - server taking too long to respond")),12e4)}),r=fetch("".concat(eH,"/api/chat/completions"),{method:"POST",headers:{"Content-Type":"application/json"},mode:"cors",body:JSON.stringify({model:tm,messages:[{role:"system",content:i},{role:"user",content:u}],temperature:.7,max_tokens:4e3,top_p:1,frequency_penalty:0,presence_penalty:0,stream:!1}),signal:t.signal}),n=await Promise.race([r,a]);if(clearTimeout(s),!n.ok){let e=await n.json().catch(()=>({}));throw Error(e.message||"API request failed: ".concat(n.status," ").concat(n.statusText))}if((e=await n.json()).choices&&e.choices[0].message.content){let t=e.choices[0].message.content;eq(t);let s=t.match(/\[GRADE:(\d)\]/);s&&s[1]&&eK(s[1]);break}throw Error("Received empty or invalid response from the API")}}catch(t){if(r=t,2===a||"AbortError"!==t.name&&!t.message.includes("NetworkError")&&!t.message.includes("Failed to fetch")&&!t.message.includes("timeout")&&!t.message.includes("500")&&!t.message.includes("503"))break;a++,e3({message:"Request failed, retrying (attempt ".concat(a," of ").concat(2,")...")});let e=3e3*a;await new Promise(t=>setTimeout(t,e))}if(r&&a>2)throw r}catch(t){console.error("Error submitting for marking:",t);let e=t.message;"AbortError"===t.name?e="Request timed out. The server took too long to respond. Please try again with a faster model.":t.message.includes("Failed to fetch")||t.message.includes("NetworkError")?e="Network error. Please check your internet connection and try again. Note that Render's free tier servers may take up to 50 seconds to wake up after inactivity.":t.message.includes("500")||t.message.includes("503")?e="Server error. The backend service might be unavailable or still starting up. If this persists, please wait a minute and try again.":t.message.includes("not a valid model ID")&&(e="The selected model is not available on the backend. Please try a different model."),eL({type:"AbortError"===t.name?"timeout":"api_error",message:"Failed to get feedback: ".concat(e)}),e_(!1);return}$("feedback"),e_(!1),e3({message:"Answer marked successfully!"})},[o,h,tZ,tc,tn,_,s,tm,m,ey,ej,ef,N,g,U]);(0,r.useEffect)(()=>{if(o&&!(o.length<20)&&!tA.current)return t_(o,m,tA,ex,u,e6,e3),()=>{"function"==typeof t_.cancel&&t_.cancel()}},[o,t_,m,ex]),(0,r.useEffect)(()=>{try{let e=new d.ZP({apiKey:"sk-not-needed",baseURL:"".concat(eH,"/api"),dangerouslyAllowBrowser:!0});tr(e)}catch(e){console.error("OpenAI client initialization failed:",e),eL({type:"initialization",message:"AI service initialization failed. Please refresh the page."})}},[]),(0,r.useEffect)(()=>{try{let e=sessionStorage.getItem("aiMarkerFormData");if(e){let t=JSON.parse(e);i(t.question||""),c(t.answer||""),u(t.subject||"english"),x(t.examBoard||"aqa"),C(t.userType||"student"),Z(t.markScheme||""),eb(t.totalMarks||""),ev(t.textExtract||""),ew(t.relevantMaterial||""),p(t.questionType||"general"),t.customSubjects&&t.customSubjects.length>0&&(eh(t.customSubjects),eg([...eQ,...t.customSubjects])),e3({message:"Previous work restored from your last session"}),setTimeout(()=>{e3(null)},3e3)}}catch(e){console.error("Error loading saved form data:",e)}},[]),(0,r.useEffect)(()=>{try{sessionStorage.setItem("aiMarkerFormData",JSON.stringify({question:s,answer:o,subject:m,examBoard:h,userType:N,markScheme:_,totalMarks:ef,textExtract:ey,relevantMaterial:ej,customSubjects:eu,questionType:g}))}catch(e){console.error("Error saving form data:",e)}},[s,o,m,h,N,_,ef,ey,ej,eu,g]);let tD=(0,r.useCallback)(()=>{i(""),c(""),eq(""),eK(""),eL(null),e3(null),J(null),Z(""),$("answer"),eb(""),ev(""),ew("")},[]);(0,r.useEffect)(()=>{let e=e=>{(e.ctrlKey||e.metaKey)&&"Enter"===e.key&&(!eF&&o&&(tq(),te("Submitted for marking")),e.preventDefault()),(e.ctrlKey||e.metaKey)&&e.shiftKey&&"r"===e.key&&(tD(),te("Form reset"),e.preventDefault()),(e.ctrlKey||e.metaKey)&&"."===e.key&&(ez(e=>!e),te("Toggled advanced options"),e.preventDefault()),(e.ctrlKey||e.metaKey)&&"/"===e.key&&(tb(e=>!e),te("Toggled help guide"),e.preventDefault()),(e.ctrlKey||e.metaKey)&&"k"===e.key&&(eE(e=>!e),te("Toggled keyboard shortcuts"),e.preventDefault()),setTimeout(()=>{te(null)},2e3)};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[eF,o,tq,tD]),(0,r.useEffect)(()=>{ec&&ep.current&&ep.current.focus()},[ec]);let tG=async()=>{if(U){tx(!0);try{let e=new FileReader,t=await new Promise(t=>{e.onload=()=>t(e.result.split(",")[1]),e.readAsDataURL(U)});e3({message:"Processing your image... Please wait."});let s=await fetch("".concat(eH,"/api/image/extract"),{method:"POST",headers:{"Content-Type":"application/json"},mode:"cors",body:JSON.stringify({image_base64:t})});if(!s.ok)throw Error("Image processing failed: ".concat(s.statusText));let a=(await s.json()).text;c(e=>e?"".concat(e,"\n").concat(a):a),e3({message:"Image processed successfully! Text has been added to your answer."}),setTimeout(()=>{e3(null)},3e3)}catch(e){console.error("Error processing image:",e),eL({type:"image_processing",message:"Failed to process the image. Please try again or enter text manually."})}finally{tx(!1),J(null)}}},tO=async()=>{if(!s){eL({type:"validation",message:"Please enter a question first to generate a mark scheme"});return}eL(null),e3(null),e_(!0),e3({message:"Generating mark scheme with relevant Assessment Objectives..."});let e=0;for(;e<=2;)try{var t,a,r;let e=await fetch("".concat(eH,"/api/chat/completions"),{method:"POST",headers:{"Content-Type":"application/json"},mode:"cors",body:JSON.stringify({model:"google/gemini-pro:free",messages:[{role:"system",content:"You are an expert in GCSE ".concat(m," for the ").concat(h.toUpperCase()," exam board. Generate a concise mark scheme with relevant Assessment Objectives (AOs) for the following question. Format using bullet points and include key marking criteria.")},{role:"user",content:s}],max_tokens:1500})});if(!e.ok)throw Error("HTTP error: ".concat(e.status));let n=await e.json(),l=(null==n?void 0:null===(r=n.choices)||void 0===r?void 0:null===(a=r[0])||void 0===a?void 0:null===(t=a.message)||void 0===t?void 0:t.content)||"No mark scheme generated. Please try again.";Z(l),e3({message:"Mark scheme generated successfully!"}),setTimeout(()=>{e3(null)},3e3);break}catch(t){console.error("Error generating mark scheme:",t),2===e?eL({type:"api_error",message:"Failed to generate mark scheme. Backend service may be starting up. Please try again in a minute.",retry:!0}):(e3({message:"Retrying mark scheme generation (".concat(e+1,"/").concat(2,")...")}),await new Promise(t=>setTimeout(t,3e3*(e+1)))),e++}e_(!1)};return(0,a.jsxs)("div",{className:"min-h-screen bg-background text-foreground",children:[(0,a.jsx)(e=>{let{version:t="2.1.0",backendStatus:s}=e;return(0,a.jsxs)("div",{className:"sticky top-0 z-10 flex items-center justify-between py-2 px-4 border-b border-border bg-card shadow-sm backdrop-blur-sm bg-opacity-90",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsx)("div",{className:"font-semibold text-xl",children:"AI GCSE Marker"}),(0,a.jsxs)("div",{className:"text-xs text-muted-foreground hidden sm:block",children:["v",t]}),s&&(0,a.jsxs)("div",{className:"hidden sm:flex items-center space-x-1",children:[(0,a.jsx)("div",{className:"h-2 w-2 rounded-full ".concat("online"===s?"bg-green-500":"rate_limited"===s?"bg-yellow-500":"bg-red-500")}),(0,a.jsx)("div",{className:"text-xs text-muted-foreground",children:"online"===s?"API Connected":"rate_limited"===s?"Rate Limited":"API Offline"})]})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(eV,{}),(0,a.jsx)(en,{children:(0,a.jsxs)(el,{children:[(0,a.jsx)(ei,{asChild:!0,children:(0,a.jsxs)(f,{variant:"ghost",size:"sm",className:"text-muted-foreground hover:text-foreground",onClick:()=>eE(!0),children:[(0,a.jsx)(B.Z,{size:18}),(0,a.jsx)("span",{className:"sr-only",children:"Keyboard shortcuts"})]})}),(0,a.jsx)(eo,{children:(0,a.jsx)("p",{children:"Keyboard shortcuts"})})]})}),(0,a.jsx)(en,{children:(0,a.jsxs)(el,{children:[(0,a.jsx)(ei,{asChild:!0,children:(0,a.jsxs)(f,{variant:"ghost",size:"sm",className:"text-muted-foreground hover:text-foreground",onClick:()=>eR(!eP),ref:e=>tv(e),children:[(0,a.jsx)(L.Z,{size:18}),(0,a.jsx)("span",{className:"sr-only",children:"Help"})]})}),(0,a.jsx)(eo,{children:(0,a.jsx)("p",{children:"Help & tips"})})]})})]})]})},{version:"2.1.1",backendStatus:tP.current}),(0,a.jsxs)("div",{className:"container mx-auto px-4 py-6 max-w-6xl",children:[eP&&(0,a.jsx)(e9,{onClose:()=>eR(!1)}),(0,a.jsx)(e2,{success:e4,error:eB}),(0,a.jsx)(e0,{onStatusChange:tz}),e5&&!tA.current&&(0,a.jsxs)("div",{className:"mb-4 p-3 bg-primary/10 border border-primary/20 rounded-md flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(O.Z,{className:"h-5 w-5 text-primary mr-2"}),(0,a.jsxs)("span",{className:"text-sm text-primary",children:["Subject detected: ",(0,a.jsx)("strong",{children:(null===(e=ex.find(e=>e.value===e5))||void 0===e?void 0:e.label)||"Unknown"})]})]}),(0,a.jsxs)("div",{className:"flex space-x-2",children:[(0,a.jsx)(f,{variant:"outline",size:"sm",className:"text-xs h-7 border-primary/20 hover:bg-primary/10",onClick:()=>{u(e5),tA.current=!0,e6(null)},children:"Accept"}),(0,a.jsx)(f,{variant:"ghost",size:"sm",className:"text-xs h-7 text-muted-foreground",onClick:()=>e6(null),children:"Dismiss"})]})]}),(0,a.jsx)(l.M,{children:e7&&(0,a.jsx)(n.E.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0},className:"fixed top-4 right-4 bg-background border border-border shadow-md text-foreground px-3 py-2 rounded-md z-50 text-sm",children:e7})}),(0,a.jsx)(ek,{open:eC,onOpenChange:eE}),(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-12 gap-6",children:[(0,a.jsx)("div",{className:"lg:col-span-7 space-y-4",children:(0,a.jsxs)(et,{value:W,onValueChange:$,className:"w-full",children:[(0,a.jsxs)(es,{className:"grid w-full grid-cols-2",children:[(0,a.jsx)(ea,{value:"answer",children:"Answer"}),(0,a.jsx)(ea,{value:"feedback",children:"Feedback"})]}),(0,a.jsxs)(er,{value:"answer",className:"pt-4 space-y-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)(eG,{htmlFor:"question",className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{children:"Question"}),(0,a.jsx)("span",{className:"text-muted-foreground text-xs ml-1",children:"(Required)"})]}),(0,a.jsx)(ed,{variant:"outline",className:"font-normal text-xs",children:"GCSE Level"})]}),(0,a.jsx)(b,{id:"question",placeholder:"Enter the question here...",className:"min-h-[60px]",value:s,onChange:e=>i(e.target.value),ref:e=>tk(e)})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)(eG,{htmlFor:"answer",children:[(0,a.jsx)("span",{children:"Your Answer"}),(0,a.jsx)("span",{className:"text-muted-foreground text-xs ml-1",children:"(Required)"})]}),(0,a.jsx)(f,{variant:"outline",size:"sm",onClick:()=>document.getElementById("image-upload").click(),className:"text-xs h-7 ml-2",disabled:th,children:th?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(D.Z,{className:"mr-1 h-3 w-3 animate-spin"})," Processing..."]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(V.Z,{className:"mr-1 h-3 w-3"})," Upload Image"]})})]}),(0,a.jsx)("input",{type:"file",id:"image-upload",accept:"image/*",className:"hidden",onChange:e=>{e.target.files&&e.target.files[0]&&J(e.target.files[0])},disabled:th}),(0,a.jsx)(b,{id:"answer",placeholder:"Enter your answer here...",className:"min-h-[150px]",value:o,onChange:e=>c(e.target.value),ref:e=>tN(e)}),U&&!th&&(0,a.jsxs)("div",{className:"mt-2 flex items-center",children:[(0,a.jsxs)(ed,{variant:"outline",className:"text-xs",children:[U.name," (",Math.round(U.size/1024)," KB)"]}),(0,a.jsx)(f,{size:"sm",variant:"ghost",className:"h-6 w-6 p-0 ml-2",onClick:()=>J(null),children:(0,a.jsx)(K.Z,{className:"h-4 w-4"})}),(0,a.jsx)(f,{size:"sm",variant:"outline",className:"text-xs h-7 ml-2",onClick:tG,children:"Process Image"})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(eG,{htmlFor:"subject",className:"text-sm",children:"Subject"}),(0,a.jsxs)(T,{value:m,onValueChange:e=>{if("custom"===e){em(!0);return}u(e),tA.current=!0},children:[(0,a.jsx)(R,{children:(0,a.jsx)(P,{placeholder:"Select a subject"})}),(0,a.jsx)(I,{children:(0,a.jsxs)(A,{children:[(0,a.jsx)(z,{children:"Common Subjects"}),ex.map(e=>(0,a.jsx)(F,{value:e.value,children:e.label},e.value)),(0,a.jsx)(F,{value:"custom",className:"text-primary",children:"+ Add Custom Subject"})]})})]}),ec&&(0,a.jsxs)("div",{className:"mt-2 flex",children:[(0,a.jsx)(eO,{ref:ep,value:X,onChange:e=>ee(e.target.value),placeholder:"Enter subject name",className:"text-sm"}),(0,a.jsx)(f,{size:"sm",className:"ml-2 px-2",onClick:()=>{if(!X.trim())return;let e={value:X.toLowerCase().replace(/\s+/g,""),label:X.trim()},t=[...eu,e];eh(t),eg([...eQ,...t]),u(e.value),em(!1),ee(""),e3({message:"Added custom subject: ".concat(e.label)}),setTimeout(()=>{e3(null)},3e3)},disabled:!X.trim(),children:"Add"}),(0,a.jsx)(f,{size:"sm",variant:"ghost",className:"ml-1 px-2",onClick:()=>em(!1),children:(0,a.jsx)(K.Z,{className:"h-4 w-4"})})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(eG,{htmlFor:"examBoard",className:"text-sm",children:"Exam Board"}),(0,a.jsxs)(T,{value:h,onValueChange:x,children:[(0,a.jsx)(R,{children:(0,a.jsx)(P,{placeholder:"Select an exam board"})}),(0,a.jsx)(I,{children:eY.map(e=>(0,a.jsx)(F,{value:e.value,children:e.label},e.value))})]})]}),"english"===m&&"aqa"===h&&(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(eG,{htmlFor:"questionType",className:"text-sm",children:"Question Type"}),(0,a.jsxs)(T,{value:g,onValueChange:p,children:[(0,a.jsx)(R,{children:(0,a.jsx)(P,{placeholder:"Select question type"})}),(0,a.jsx)(I,{children:eX.english.aqa.map(e=>(0,a.jsx)(F,{value:e.value,children:e.label},e.value))})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(eG,{htmlFor:"userType",className:"text-sm",children:"I am a"}),(0,a.jsxs)(T,{value:N,onValueChange:C,children:[(0,a.jsx)(R,{children:(0,a.jsx)(P,{placeholder:"Select user type"})}),(0,a.jsx)(I,{children:eJ.map(e=>(0,a.jsx)(F,{value:e.value,children:e.label},e.value))})]})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)(f,{variant:"outline",size:"sm",onClick:()=>ez(!eI),className:"text-xs",children:[eI?(0,a.jsx)(E.Z,{className:"mr-1 h-3 w-3"}):(0,a.jsx)(S.Z,{className:"mr-1 h-3 w-3"}),"Advanced Options"]}),eI&&(0,a.jsxs)("div",{className:"mt-3 space-y-4 border p-4 rounded-md bg-muted/30 border-border",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsxs)(eG,{htmlFor:"markScheme",className:"text-sm",children:["Mark Scheme ",(0,a.jsx)("span",{className:"text-muted-foreground text-xs",children:"(Optional)"})]}),(0,a.jsxs)(f,{variant:"outline",size:"sm",className:"text-xs h-7",onClick:tO,disabled:eF||!s||"online"!==tP.current,ref:e=>tT(e),children:[eF?(0,a.jsx)(D.Z,{className:"mr-1 h-3 w-3 animate-spin"}):(0,a.jsx)(H.Z,{className:"mr-1 h-3 w-3"}),"Generate"]})]}),(0,a.jsx)(b,{id:"markScheme",placeholder:"Enter mark scheme details...",className:"min-h-[100px]",value:_,onChange:e=>Z(e.target.value)})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)(eG,{htmlFor:"totalMarks",className:"text-sm",children:["Total Marks ",(0,a.jsx)("span",{className:"text-muted-foreground text-xs",children:"(Optional)"})]}),(0,a.jsx)(eO,{id:"totalMarks",type:"number",placeholder:"e.g., 20",value:ef,onChange:e=>eb(e.target.value),className:"max-w-[120px]",ref:e=>tC(e)})]}),"english"===m&&(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)(eG,{htmlFor:"textExtract",className:"text-sm",children:["Text Extract ",(0,a.jsx)("span",{className:"text-muted-foreground text-xs",children:"(Optional)"})]}),(0,a.jsx)(b,{id:"textExtract",placeholder:"Enter any text extract the question refers to...",className:"min-h-[100px]",value:ey,onChange:e=>ev(e.target.value)})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)(eG,{htmlFor:"relevantMaterial",className:"text-sm",children:["Relevant Material ",(0,a.jsx)("span",{className:"text-muted-foreground text-xs",children:"(Optional)"})]}),(0,a.jsx)(b,{id:"relevantMaterial",placeholder:"Enter any additional context, notes or material...",className:"min-h-[100px]",value:ej,onChange:e=>ew(e.target.value)})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)(eG,{htmlFor:"aiModel",className:"text-sm",children:["AI Model ",(0,a.jsx)("span",{className:"text-muted-foreground text-xs",children:"(Optional)"})]}),(0,a.jsxs)(T,{value:tm,onValueChange:tu,children:[(0,a.jsx)(R,{children:(0,a.jsx)(P,{placeholder:"Select AI model"})}),(0,a.jsx)(I,{children:eW.map(e=>(0,a.jsx)(F,{value:e.value,className:"py-2",children:(0,a.jsxs)("div",{className:"flex flex-col",children:[(0,a.jsx)("span",{children:e.label}),(0,a.jsx)("span",{className:"text-xs text-muted-foreground",children:e.description})]})},e.value))})]})]})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(f,{onClick:tq,disabled:eF||!o||"online"!==tP.current,className:"w-full",children:eF?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(D.Z,{className:"mr-2 h-4 w-4 animate-spin"}),"Processing..."]}):"online"!==tP.current?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(q.Z,{className:"mr-2 h-4 w-4"}),"Wake up API first"]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(G.Z,{className:"mr-2 h-4 w-4"}),"Mark Answer"]})}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsxs)(f,{variant:"outline",size:"sm",onClick:tD,className:"text-xs",disabled:eF,children:[(0,a.jsx)(M.Z,{className:"mr-1 h-3 w-3"}),"Reset Form"]}),(0,a.jsx)(en,{children:(0,a.jsxs)(el,{children:[(0,a.jsx)(ei,{asChild:!0,children:(0,a.jsxs)(f,{variant:"outline",size:"sm",onClick:()=>eE(!0),className:"text-xs",children:[(0,a.jsx)(B.Z,{className:"mr-1 h-3 w-3"}),"Shortcuts"]})}),(0,a.jsx)(eo,{children:(0,a.jsx)("p",{children:"View keyboard shortcuts"})})]})})]})]})]}),(0,a.jsxs)(er,{value:"feedback",className:"pt-4 relative",children:[(0,a.jsx)(e1,{loading:eF,progress:tt}),(eF||eN)&&"deepseek/deepseek-r1:free"===tm&&(0,a.jsx)(e=>{let{thinking:t,loading:s}=e,[n,l]=(0,r.useState)(!1);return t||s?(0,a.jsxs)("div",{className:"mb-4 p-3 bg-gray-50 dark:bg-gray-900 border border-gray-200 dark:border-gray-800 rounded-md",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Model Thinking Process"}),s&&!t?(0,a.jsxs)(ed,{variant:"outline",className:"ml-2 px-1.5 py-0 text-xs bg-blue-50 text-blue-800 dark:bg-blue-900/20 dark:text-blue-300",children:[(0,a.jsx)(D.Z,{className:"mr-1 h-3 w-3 animate-spin"}),"Processing..."]}):(0,a.jsx)(ed,{variant:"outline",className:"ml-2 px-1.5 py-0 text-xs",children:"Step-by-Step Reasoning"})]}),(0,a.jsx)(f,{variant:"ghost",size:"sm",className:"h-7 w-7 p-0 rounded-full",onClick:()=>l(!n),children:n?(0,a.jsx)(E.Z,{size:16,className:"text-gray-500 dark:text-gray-400"}):(0,a.jsx)(S.Z,{size:16,className:"text-gray-500 dark:text-gray-400"})})]}),(0,a.jsx)("div",{className:"overflow-y-auto text-sm text-gray-600 dark:text-gray-400 whitespace-pre-wrap transition-all duration-300 font-mono border border-gray-100 dark:border-gray-800 p-2 rounded bg-white dark:bg-gray-950 ".concat(n?"max-h-[500px]":"max-h-48"),children:s&&!t?(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center py-4 text-gray-400",children:[(0,a.jsx)(D.Z,{className:"h-4 w-4 animate-spin mb-2"}),(0,a.jsx)("span",{children:"Waiting for the model to start thinking..."})]}):t?t.includes("[THINKING]")?t.split("[THINKING]")[1].split("[FEEDBACK]")[0]:t:"Waiting for model's thinking process..."})]}):null},{thinking:eN,loading:eF}),eZ?(0,a.jsx)(e8,{feedback:eZ,grade:eD,modelName:(null===(t=eW.find(e=>e.value===tm))||void 0===t?void 0:t.label)||"AI"}):(0,a.jsxs)("div",{className:"min-h-[300px] flex flex-col items-center justify-center text-center p-6 border border-dashed border-border rounded-lg bg-muted/20",children:[(0,a.jsx)("div",{className:"mb-4 p-3 rounded-full bg-muted",children:(0,a.jsx)(L.Z,{className:"h-6 w-6 text-muted-foreground"})}),(0,a.jsx)("h3",{className:"text-lg font-medium mb-2",children:"No Feedback Yet"}),(0,a.jsx)("p",{className:"text-muted-foreground max-w-md mb-6",children:'Enter your question and answer in the Answer tab, then click "Mark Answer" to receive AI feedback and a GCSE grade.'}),(0,a.jsx)(f,{variant:"outline",onClick:()=>$("answer"),className:"text-sm",children:"Go to Answer Tab"})]})]})]})}),(0,a.jsx)("div",{className:"lg:col-span-5",children:(0,a.jsxs)(y,{className:"h-full",children:[(0,a.jsxs)(v,{children:[(0,a.jsx)(j,{className:"text-lg",children:"GCSE Assessment Tools"}),(0,a.jsx)(k,{children:"Our AI tool helps you practice and improve your GCSE exam skills"})]}),(0,a.jsx)(w,{children:(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,a.jsx)("div",{className:"mt-0.5 bg-primary/10 p-1.5 rounded-full",children:(0,a.jsx)(O.Z,{className:"h-4 w-4 text-primary"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"font-medium text-sm",children:"Expert Marking"}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Get detailed feedback and suggestions from our AI marker"})]})]}),(0,a.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,a.jsx)("div",{className:"mt-0.5 bg-primary/10 p-1.5 rounded-full",children:(0,a.jsx)(O.Z,{className:"h-4 w-4 text-primary"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"font-medium text-sm",children:"Subject Specific"}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Tailored to each GCSE subject and exam board requirements"})]})]}),(0,a.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,a.jsx)("div",{className:"mt-0.5 bg-primary/10 p-1.5 rounded-full",children:(0,a.jsx)(O.Z,{className:"h-4 w-4 text-primary"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"font-medium text-sm",children:"Practice on Your Schedule"}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"24/7 access to improve your skills whenever you have time"})]})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"font-medium text-sm mb-2",children:"Quick Tips"}),(0,a.jsxs)("ul",{className:"text-sm text-muted-foreground space-y-2",children:[(0,a.jsxs)("li",{className:"flex items-start",children:[(0,a.jsx)(Q.Z,{className:"h-4 w-4 mr-1 flex-shrink-0 text-muted-foreground"}),(0,a.jsx)("span",{children:"Enter both the question and your full answer"})]}),(0,a.jsxs)("li",{className:"flex items-start",children:[(0,a.jsx)(Q.Z,{className:"h-4 w-4 mr-1 flex-shrink-0 text-muted-foreground"}),(0,a.jsx)("span",{children:"Select the correct subject and exam board"})]}),(0,a.jsxs)("li",{className:"flex items-start",children:[(0,a.jsx)(Q.Z,{className:"h-4 w-4 mr-1 flex-shrink-0 text-muted-foreground"}),(0,a.jsx)("span",{children:"For best results, provide clear and complete answers"})]}),(0,a.jsxs)("li",{className:"flex items-start",children:[(0,a.jsx)(Q.Z,{className:"h-4 w-4 mr-1 flex-shrink-0 text-muted-foreground"}),(0,a.jsx)("span",{children:"Wait for the backend to wake up when you first visit the site (may take up to 60 seconds)"})]})]})]}),(0,a.jsx)("div",{className:"pt-4 border-t border-border",children:(0,a.jsxs)(f,{variant:"outline",size:"sm",className:"w-full",onClick:()=>window.open("https://github.com/beenycool/beenycool.github.io/issues","_blank"),children:[(0,a.jsx)(Y.Z,{className:"mr-2 h-4 w-4"}),"Report an Issue or Suggest a Feature"]})})]})})]})})]})]})]})}}}]);